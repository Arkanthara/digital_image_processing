---
title: Convolution VS correlation
author: Michel Donnet
date: \today
---

# Convolution: formula

$$(f \ast w)(x, y) = \sum_{s=-a}^a \sum_{t = -b}^{b} w(s, t)f(x - s, y - t)$$

# Correlation: formula

$$(f \circ w)(x, y) = \sum_{s=-a}^a \sum_{t = -b}^{b} w(s, t)f(x + s, y + t)$$

# Associativity

$$f * (h_1 * h_2) = (f * h_1) * h_2 ?$$

$$f * (h_1 * h_2)(x, y) = \sum_{s=-a}^a \sum_{t = -b}^{b} (h_1 * h_2)(s, t)f(x - s, y - t)$$
$$= \sum_{s=-a}^a \sum_{t = -b}^{b} \left(\sum_{u=-a}^s \sum_{v=-b}^t h_2(u, v)h_1(s - u, t - v)\right)f(x - s, y - t)$$
$$= \sum_{-a \leq u \leq s \leq a} \sum_{-b \leq v \leq t \leq b} h_2(u, v)h_1(s - u, t - v)f(x - s, y - t)$$

$$= \sum_{-a \leq u \leq s \leq a} \sum_{-b \leq v \leq t \leq b} h_2(u, v)h_1(s - u, t - v)f(x - s, y - t)$$
$$= \sum_{u=-a}^a \sum_{v = -b}^{b} h_2(u, v) \left(\sum_{s=u}^a \sum_{t=v}^b h_1(s - u, t - v)f(x - s, y - t)\right)$$

$$= \sum_{u=-c}^c \sum_{v=-d}^d h_2(u, v)\left(\sum_{s=-a}^a \sum_{t = -b}^{b} h_1(s - u, t - v)f(x - s, y - t)\right)$$
if we remplace s by s + u and t by t + v, we have:
$$= \sum_{u=-c}^c \sum_{v=-d}^d h_2(u, v)\left(\sum_{(s + u)=-(a+c)}^{a+c} \sum_{(t + v) = -(b+d)}^{b + d} h_1(s, t)f(x - (s + u), y - (t + v))\right)$$
$$= \sum_{u=-c}^c \sum_{v=-d}^d h_2(u, v)\left( (f * h_1)(x-u, y-v)\right)$$
$$= ((f * h_1) * h_2)(x, y)$$



$$f * (h_1 * h_2)(x, y) = \sum_{s=-a}^a \sum_{t = -b}^{b} w(s, t)f(x - s, y - t)$$
and

$$(h_1 * h_2)(x, y) = \sum_{u=-a}^a \sum_{v = -b}^{b} h_2(u, v)h_1(x - u, y - v)$$

# Commutativity

$$(f * w)(x, y) = \sum_s \sum_t w(s, t)f(x - s, y - t)$$

If we define s = x - s and t = y - t, we have:


$$\sum_s \sum_t w(s, t)f(x - s, y - t) = \sum_{x-s} \sum_{y - t} w(x - s, y - t) f (s, t) = (w * f)(x, y)$$

# Distributivity of convolution


$$(f * (h_1 + h_2))(x, y)$$
$$=\sum_s \sum_t (h_1 + h_2)(s, t)f(x - s, y - t)$$
$$=\sum_s \sum_t (h_1(s, t) + h_2(s, t))f(x - s, y - t)$$
$$=\sum_s \sum_t h_1(s, t)f(x - s, y - t) + h_2(s, t)f(x - s, y - t)$$
$$=\sum_s \sum_t h_1(s, t)f(x - s, y - t) + \sum_s \sum_t h_2(s, t)f(x - s, y - t)$$
$$= (f * h_1)(x, y) + (f * h_2)(x, y)$$

# Distributivity of correlation


$$(f \circ (h_1 + h_2))(x, y)$$
$$=\sum_s \sum_t (h_1 + h_2)(s, t)f(x + s, y + t)$$
$$=\sum_s \sum_t (h_1(s, t) + h_2(s, t))f(x + s, y + t)$$
$$=\sum_s \sum_t h_1(s, t)f(x + s, y + t) + h_2(s, t)f(x + s, y + t)$$
$$=\sum_s \sum_t h_1(s, t)f(x + s, y + t) + \sum_s \sum_t h_2(s, t)f(x + s, y + t)$$
$$= (f \circ h_1)(x, y) + (f \circ h_2)(x, y)$$
